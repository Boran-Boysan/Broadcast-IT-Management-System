<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Çalışanlar İçin Kayıt Formu</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/register.css') }}">
</head>

<body>

    <div class="container">

        <div class="header-nav">
            <button type="button" class="btn-home" onclick="goToHomePage()">Ana Sayfa</button>
        </div>

        <h1>Çalışan Kayıt Formu</h1>

        <form id="employeeForm" action="/add_employee" method="POST">
            <div class="form-row">

                <div class="form-group">
                    <label for="name">Ad *</label>
                    <input type="text" id="name" name="name" required maxlength="30" placeholder="Çalışanın adı">
                </div>

                <div class="form-group">
                    <label for="surname">Soyad *</label>
                    <input type="text" id="surname" name="surname" required maxlength="30" placeholder="Çalışanın soyadı">
                </div>

            </div>

            <div class="form-group">
                <label for="email">E-posta *</label>
                <input type="email" id="email" name="email" required maxlength="50" placeholder="ornek@email.com">
            </div>

            <div class="form-group">
                <label for="password">Şifre *</label>
                <input type="password" id="password" name="password" required placeholder="Güvenli bir şifre girin">
            </div>

            <div class="form-row">

                <div class="form-group">
                    <label for="department">Departman</label>

                    <select id="department" name="department">
                        <option value="">Departman seçin</option>
                        <option value="IT">Bilgi İşlem (IT)</option>
                        <option value="HR">İnsan Kaynakları (HR)</option>
                        <option value="Sales">Satış</option>
                        <option value="Marketing">Pazarlama</option>
                        <option value="Finance">Finans</option>
                        <option value="Operations">Operasyon</option>
                        <option value="Legal">Hukuk</option>
                        <option value="R&D">Ar-Ge</option>
                    </select>

                </div>

                <div class="form-group">
                    <label for="role">Rol *</label>

                    <select id="role" name="role" required>
                        <option value="">Rol seçin</option>
                        <option value="admin">Yönetici (Admin)</option>
                        <option value="manager">Müdür (Manager)</option>
                        <option value="user">Kullanıcı (User)</option>
                    </select>

                </div>

            </div>

            <div class="btn-container">

                <button type="submit" class="btn-primary">
                    Çalışan Ekle
                </button>

                <button type="reset" class="btn-secondary">
                    Formu Temizle
                </button>

            </div>

        </form>
    </div>

    <script>

        function goToHomePage() {
            window.location.href = '/';
        }

        document.getElementById('employeeForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const data = Object.fromEntries(formData);

            const hashedPassword = 'scrypt:32768:8:1$' + btoa(data.password + 'salt').substring(0, 50);

            const sql = `INSERT INTO employee (name, surname, email, password_hash, department, role, date_joined)
            VALUES ('${data.name}', '${data.surname}', '${data.email}', '${hashedPassword}', '${data.department || null}', '${data.role}', NOW());`;

            alert('SQL Komutu oluşturuldu! Console\'da görüntüleyin.\n\nÇalışan: ' + data.name + ' ' + data.surname + '\nE-posta: ' + data.email + '\nRol: ' + data.role);

            console.log('=== POSTGRESQL INSERT KOMUTU ===');
            console.log(sql);
            console.log('=== FORM VERİLERİ ===');
            console.log(data);

            // Formu temizle
            this.reset();
        });

        document.getElementById('email').addEventListener('blur', function() {
            const email = this.value;
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

            if (email && !emailRegex.test(email)) {
                this.style.borderColor = '#dc3545';
                this.style.backgroundColor = '#fff5f5';
            } else {
                this.style.borderColor = '#28a745';
                this.style.backgroundColor = '#f0fff4';
            }
        });

        document.getElementById('password').addEventListener('input', function() {
            const password = this.value;
            const strength = getPasswordStrength(password);

            if (strength === 'weak') {
                this.style.borderColor = '#dc3545';
            } else if (strength === 'medium') {
                this.style.borderColor = '#ffc107';
            } else if (strength === 'strong') {
                this.style.borderColor = '#28a745';
            }
        });

        function getPasswordStrength(password) {
            if (password.length < 6) return 'weak';
            if (password.length >= 6 && password.length < 10) return 'medium';
            if (password.length >= 10) return 'strong';
        }
    </script>

</body>
</html>